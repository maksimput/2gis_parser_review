# REVIEW PARSER 2GIS
***
### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä –æ—Ç–∑—ã–≤–æ–≤ –∏–∑ 2GIS
***
### ‚öôÔ∏è –†–∞–±–æ—Ç–∞
–°–∫—Ä–∏–ø—Ç –ø–∞—Ä—Å–∏—Ç –æ—Ç–∑—ã–≤—ã —Å –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–π 2GIS –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ CSV-—Ñ–∞–π–ª –≤ —Ñ–æ—Ä–º–∞—Ç–µ —Ç–∞–±–ª–∏—Ü—ã. 
–¢–∞–±–ª–∏—Ü–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ (reviews.csv). 
–î–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–æ–≤ —Å–∫—Ä–∏–ø—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç id –≤—Å–µ—Ö —Å–ø–∞—Ä—à–µ–Ω–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π .txt —Ñ–∞–π–ª. –ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è id –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞.
### ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ 
1. –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–Ω–µ–æ–±—Ö–æ–¥–∏–º GIT)
``` bash
git clone https://github.com/maksimput/2gis_parser_review.git
```
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –ø—Ä–æ–µ–∫—Ç–æ–º –∏ —Å–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑ (–Ω–µ–æ–±—Ö–æ–¥–∏–º Docker)
``` bash
cd 2gis_parser_review
sudo docker build -t 2gis_parser_review .
```
### üöÄ –ó–∞–ø—É—Å–∫
``` bash
docker run --rm \
  -e BRANCH_URLS="–°—Å—ã–ª–∫–∏ –Ω–∞ –∑–∞–≤–µ–¥–µ–Ω–∏—è, –æ—Ç–∫—É–¥–∞ –Ω—É–∂–Ω–æ —Å–æ–±—Ä–∞—Ç—å –æ—Ç–∑—ã–≤—ã (–ø—Ä–∏–º–µ—Ä —Ñ–æ—Ä–º–∞—Ç–∞ - https://2gis.ru/ufa/firm/2393065583018885,https://2gis.ru/ufa/firm/2393066583092767,https://2gis.ru/ufa/firm/2393066583119255).
   –°—Å—ã–ª–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –±–µ–∑ /  –≤ –∫–æ–Ω—Ü–µ. –ï—Å–ª–∏ —Å—Å—ã–ª–æ–∫ –Ω–µ—Å–∫–æ–ª—å–∫–æ, —É–∫–∞–∑—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é" \
  -e TG_BOT_TOKEN="–¢–æ–∫–µ–Ω TG-–±–æ—Ç–∞" \
  -e TG_CHAT_ID="CHAT_ID TG –∫–∞–Ω–∞–ª–∞, –∫—É–¥–∞ –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è" \
  -e API_KEY="API –∫–ª—é—á 2GIS" \
  -v "$PWD:/app" \
  2gis_parser_review
```

### ‚ùì –ì–¥–µ –≤–∑—è—Ç—å API-–∫–ª—é—á 2GIS? 
1. –û—Ç–∫—Ä—ã–≤–∞–µ–º –æ—Ç–∑—ã–≤—ã –ª—é–±–æ–≥–æ –∑–∞–≤–µ–¥–µ–Ω–∏—è 2GIS (–Ω–∞–ø—Ä–∏–º–µ—Ä https://2gis.ru/ufa/inside/2393172957240294/firm/2393066583092767/55.995445%2C54.697511/tab/reviews?m=55.995521%2C54.697518%2F18)
2. –ù–∞–∂–∏–º–∞–µ–º F12, –æ—á–∏—â–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤, –æ–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
3. –ò—â–µ–º –∑–∞–ø—Ä–æ—Å —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º reviews?limit=...... (–µ—Å–ª–∏ –Ω–µ –Ω–∞—Ö–æ–¥–∏–º —Ç–∞–∫–æ–π –∑–∞–ø—Ä–æ—Å, —Ç–æ –ª–∏—Å—Ç–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ–Ω–∏–∂–µ –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ 50 –æ—Ç–∑—ã–≤–æ–≤)
4. –í –∑–∞–ø—Ä–æ—Å–µ –∏—â–µ–º key = ... 
–ü—Ä–∏–º–µ—Ä :
public-api.reviews.2gis.com/2.0/branches/2393066583092767/reviews?limit=50&offset=50&is_advertiser=false&fields=meta.providers,meta.branch_rating,meta.branch_reviews_count,meta.total_count,reviews.hiding_reason,reviews.is_verified,reviews.emojis&without_my_first_review=false&rated=true&sort_by=friends&
**key=6e7e1929-4ea9-4a5d-8c05-d601860389bd**&locale=ru_RU
### ‚öôÔ∏è –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ —Ä–∞–∑ –≤ —Å—É—Ç–∫–∏ —á–µ—Ä–µ–∑ CRON
1. –í —Å–∫—Ä–∏–ø—Ç–µ run_2gis_parser.sh –∏–∑–º–µ–Ω–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å–æ —Å–≤–æ–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
2. –û—Ç–∫—Ä—ã—Ç—å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ CRON
``` bash 
crontab -e 
```
–í–ø–∏—Å–∞—Ç—å –≤ —Ñ–∞–π–ª —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä–æ–∫—É: 
``` bash 
0 18 * * * '/home/administrator/–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª/review/2gis_parser_review/run_2gis_parser.sh' >> /tmp/reviews.log 2>&1
```
–ì–¥–µ 
``` bash 
/home/administrator/–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª/review/2gis_parser_review/run_2gis_parser.sh 
```
–ø—É—Ç—å –¥–æ —Å–∫—Ä–∏–ø—Ç–∞ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–∑—ã–≤–æ–≤ –±—É–¥–µ—Ç –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å—Å—è —Ä–∞–∑ –≤ —Å—É—Ç–∫–∏ –≤ 18 —á–∞—Å–æ–≤.